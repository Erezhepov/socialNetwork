"use strict";(self.webpackChunkpractice=self.webpackChunkpractice||[]).push([[342],{9342:function(e,r,n){n.r(r),n.d(r,{default:function(){return se}});var t=n(2791),o=n(9439),i="Messages_messages__NoQOw",a=n(3366),s=n(7462),l=n(8182),c=n(4419),u=n(6934),d=n(1402),v=n(4036),f=n(5878),h=n(1217);function m(e){return(0,h.Z)("MuiSvgIcon",e)}(0,f.Z)("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);var p=n(184),g=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],x=(0,u.ZP)("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:function(e,r){var n=e.ownerState;return[r.root,"inherit"!==n.color&&r["color".concat((0,v.Z)(n.color))],r["fontSize".concat((0,v.Z)(n.fontSize))]]}})((function(e){var r,n,t,o,i,a,s,l,c,u,d,v,f,h,m,p,g,x=e.theme,S=e.ownerState;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:S.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:null==(r=x.transitions)||null==(n=r.create)?void 0:n.call(r,"fill",{duration:null==(t=x.transitions)||null==(o=t.duration)?void 0:o.shorter}),fontSize:{inherit:"inherit",small:(null==(i=x.typography)||null==(a=i.pxToRem)?void 0:a.call(i,20))||"1.25rem",medium:(null==(s=x.typography)||null==(l=s.pxToRem)?void 0:l.call(s,24))||"1.5rem",large:(null==(c=x.typography)||null==(u=c.pxToRem)?void 0:u.call(c,35))||"2.1875rem"}[S.fontSize],color:null!=(d=null==(v=(x.vars||x).palette)||null==(f=v[S.color])?void 0:f.main)?d:{action:null==(h=(x.vars||x).palette)||null==(m=h.action)?void 0:m.active,disabled:null==(p=(x.vars||x).palette)||null==(g=p.action)?void 0:g.disabled,inherit:void 0}[S.color]}})),S=t.forwardRef((function(e,r){var n=(0,d.Z)({props:e,name:"MuiSvgIcon"}),o=n.children,i=n.className,u=n.color,f=void 0===u?"inherit":u,h=n.component,S=void 0===h?"svg":h,Z=n.fontSize,w=void 0===Z?"medium":Z,j=n.htmlColor,y=n.inheritViewBox,b=void 0!==y&&y,k=n.titleAccess,z=n.viewBox,N=void 0===z?"0 0 24 24":z,M=(0,a.Z)(n,g),R=t.isValidElement(o)&&"svg"===o.type,I=(0,s.Z)({},n,{color:f,component:S,fontSize:w,instanceFontSize:e.fontSize,inheritViewBox:b,viewBox:N,hasSvgAsChild:R}),E={};b||(E.viewBox=N);var A=function(e){var r=e.color,n=e.fontSize,t=e.classes,o={root:["root","inherit"!==r&&"color".concat((0,v.Z)(r)),"fontSize".concat((0,v.Z)(n))]};return(0,c.Z)(o,m,t)}(I);return(0,p.jsxs)(x,(0,s.Z)({as:S,className:(0,l.Z)(A.root,i),focusable:"false",color:j,"aria-hidden":!k||void 0,role:k?"img":void 0,ref:r},E,M,R&&o.props,{ownerState:I,children:[R?o.props.children:o,k?(0,p.jsx)("title",{children:k}):null]}))}));S.muiName="SvgIcon";var Z=S;var w=function(e,r){function n(n,t){return(0,p.jsx)(Z,(0,s.Z)({"data-testid":"".concat(r,"Icon"),ref:t},n,{children:e}))}return n.muiName=Z.muiName,t.memo(t.forwardRef(n))}((0,p.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");function j(e){return(0,h.Z)("MuiAvatar",e)}(0,f.Z)("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);var y=["alt","children","className","component","imgProps","sizes","src","srcSet","variant"],b=(0,u.ZP)("div",{name:"MuiAvatar",slot:"Root",overridesResolver:function(e,r){var n=e.ownerState;return[r.root,r[n.variant],n.colorDefault&&r.colorDefault]}})((function(e){var r=e.theme,n=e.ownerState;return(0,s.Z)({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:r.typography.fontFamily,fontSize:r.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none"},"rounded"===n.variant&&{borderRadius:(r.vars||r).shape.borderRadius},"square"===n.variant&&{borderRadius:0},n.colorDefault&&(0,s.Z)({color:(r.vars||r).palette.background.default},r.vars?{backgroundColor:r.vars.palette.Avatar.defaultBg}:{backgroundColor:"light"===r.palette.mode?r.palette.grey[400]:r.palette.grey[600]}))})),k=(0,u.ZP)("img",{name:"MuiAvatar",slot:"Img",overridesResolver:function(e,r){return r.img}})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),z=(0,u.ZP)(w,{name:"MuiAvatar",slot:"Fallback",overridesResolver:function(e,r){return r.fallback}})({width:"75%",height:"75%"});var N,M=t.forwardRef((function(e,r){var n=(0,d.Z)({props:e,name:"MuiAvatar"}),i=n.alt,u=n.children,v=n.className,f=n.component,h=void 0===f?"div":f,m=n.imgProps,g=n.sizes,x=n.src,S=n.srcSet,Z=n.variant,w=void 0===Z?"circular":Z,N=(0,a.Z)(n,y),M=null,R=function(e){var r=e.crossOrigin,n=e.referrerPolicy,i=e.src,a=e.srcSet,s=t.useState(!1),l=(0,o.Z)(s,2),c=l[0],u=l[1];return t.useEffect((function(){if(i||a){u(!1);var e=!0,t=new Image;return t.onload=function(){e&&u("loaded")},t.onerror=function(){e&&u("error")},t.crossOrigin=r,t.referrerPolicy=n,t.src=i,a&&(t.srcset=a),function(){e=!1}}}),[r,n,i,a]),c}((0,s.Z)({},m,{src:x,srcSet:S})),I=x||S,E=I&&"error"!==R,A=(0,s.Z)({},n,{colorDefault:!E,component:h,variant:w}),C=function(e){var r=e.classes,n={root:["root",e.variant,e.colorDefault&&"colorDefault"],img:["img"],fallback:["fallback"]};return(0,c.Z)(n,j,r)}(A);return M=E?(0,p.jsx)(k,(0,s.Z)({alt:i,src:x,srcSet:S,sizes:g,ownerState:A,className:C.img},m)):null!=u?u:I&&i?i[0]:(0,p.jsx)(z,{ownerState:A,className:C.fallback}),(0,p.jsx)(b,(0,s.Z)({as:h,ownerState:A,className:(0,l.Z)(C.root,v),ref:r},N,{children:M}))})),R="Message_item__rK0d9",I="Message_message__gAVOh",E="Message_user__HDo5g",A=n(1087),C=t.memo((function(e){return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:R,style:{display:"flex",columnGap:10},children:[(0,p.jsxs)("div",{className:E,children:[(0,p.jsx)(A.rU,{to:"/profile/"+e.userId,children:(0,p.jsx)(M,{style:{width:"50px",height:"50px"},src:e.photo||"https://img.freepik.com/free-icon/user_318-159711.jpg"})}),(0,p.jsx)("div",{children:null===e||void 0===e?void 0:e.userName})]}),(0,p.jsx)("div",{className:I,children:(0,p.jsx)("div",{children:null===e||void 0===e?void 0:e.message})})]}),(0,p.jsx)("hr",{})]})})),_=n(1573),P=function(){var e=(0,_.i)((function(e){return e.chat.messages})),r=(0,t.useRef)(null),n=(0,t.useState)(!0),a=(0,o.Z)(n,2),s=a[0],l=a[1];return(0,t.useEffect)((function(){var e;s&&(null===(e=r.current)||void 0===e||e.scrollIntoView({block:"end"}))}),[e]),(0,p.jsxs)("div",{className:i,onScroll:function(e){var r=e.currentTarget;Math.abs(r.scrollHeight-r.scrollTop-r.clientHeight)<200?!s&&l(!0):s&&l(!1)},children:[e.map((function(e,r){return(0,p.jsx)(C,{message:e.message,userId:e.userId,userName:e.userName,photo:e.photo},r)})),(0,p.jsx)("div",{ref:r})]})},L=n(9434),D=n(4165),B=n(5861),T={"message-received":[],"status-changed":[]},F=function(e){var r=JSON.parse(e.data);T["message-received"].forEach((function(e){return e(r)}))};function V(){K("pending"),setTimeout(G,3e3)}function H(){K("error")}function O(){var e,r,n,t;null===(e=N)||void 0===e||e.removeEventListener("close",V),null===(r=N)||void 0===r||r.removeEventListener("message",V),null===(n=N)||void 0===n||n.removeEventListener("open",q),null===(t=N)||void 0===t||t.removeEventListener("error",H)}function q(){K("ready")}function K(e){T["status-changed"].forEach((function(r){return r(e)}))}function G(){var e,r,n,t,o;O(),null===(e=N)||void 0===e||e.close(),N=new WebSocket("wss://social-network.samuraijs.com/handlers/ChatHandler.ashx"),K("pending"),null===(r=N)||void 0===r||r.addEventListener("close",V),null===(n=N)||void 0===n||n.addEventListener("message",F),null===(t=N)||void 0===t||t.addEventListener("open",q),null===(o=N)||void 0===o||o.addEventListener("error",H)}var J=function(){G()},Q=function(){var e;T["message-received"]=[],T["status-changed"]=[],O(),null===(e=N)||void 0===e||e.close()},U=function(e,r){T[e].push(r)},W=function(e,r){T[e]=T[e].filter((function(e){return e!==r}))},X=function(e){var r;null===(r=N)||void 0===r||r.send(e)},Y=n(1549),$=null,ee=function(e){return null===$&&($=function(r){e(te(r))}),$},re=null,ne=function(e){return null===re&&(re=function(r){e(oe(r))}),re},te=function(e){return{type:Y.lM,payload:e}},oe=function(e){return{type:Y.KT,payload:e}},ie=function(){var e=(0,_.i)((function(e){return e.chat.status})),r=(0,L.I0)();return(0,t.useEffect)((function(){return r(function(){var e=(0,B.Z)((0,D.Z)().mark((function e(r){return(0,D.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:J(),U("message-received",ee(r)),U("status-changed",ne(r));case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),function(){r(function(){var e=(0,B.Z)((0,D.Z)().mark((function e(r){return(0,D.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:W("message-received",ee(r)),W("status-changed",ee(r)),Q();case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}())}}),[]),"error"===e?(0,p.jsx)("div",{children:"Some error has occurred. Please refresh the page."}):(0,p.jsxs)("div",{children:[(0,p.jsx)(P,{}),(0,p.jsx)(ae,{})]})},ae=function(){var e=(0,t.useState)(""),r=(0,o.Z)(e,2),n=r[0],i=r[1],a=(0,_.i)((function(e){return e.chat.status})),s=(0,L.I0)();return(0,p.jsxs)("div",{children:["pending"===a&&(0,p.jsx)("div",{children:"Loading..."}),(0,p.jsx)("div",{children:(0,p.jsx)("textarea",{onChange:function(e){return i(e.target.value)},value:n,name:"addMessageForm"})}),(0,p.jsx)("button",{disabled:0===n.length||"ready"!==a,onClick:function(){var e;n&&(s((e=n,function(){var r=(0,B.Z)((0,D.Z)().mark((function r(n){return(0,D.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:X(e);case 1:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())),i(""))},children:"Send"})]})},se=function(){return(0,p.jsx)("div",{children:(0,p.jsx)(ie,{})})}}}]);
//# sourceMappingURL=342.8c9e8d55.chunk.js.map