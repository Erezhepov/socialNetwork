"use strict";(self.webpackChunkpractice=self.webpackChunkpractice||[]).push([[934],{1934:function(e,r,n){n.r(r),n.d(r,{default:function(){return ae}});var t=n(2791),o=n(9439),i="Messages_messages__NoQOw",a=n(3366),s=n(7462),l=n(8182),c=n(4419),u=n(6934),d=n(1402),v=n(9201),f=n(184),m=(0,v.Z)((0,f.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person"),h=n(5878),p=n(1217);function g(e){return(0,p.Z)("MuiAvatar",e)}(0,h.Z)("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);var x=["alt","children","className","component","imgProps","sizes","src","srcSet","variant"],S=(0,u.ZP)("div",{name:"MuiAvatar",slot:"Root",overridesResolver:function(e,r){var n=e.ownerState;return[r.root,r[n.variant],n.colorDefault&&r.colorDefault]}})((function(e){var r=e.theme,n=e.ownerState;return(0,s.Z)({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:r.typography.fontFamily,fontSize:r.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none"},"rounded"===n.variant&&{borderRadius:(r.vars||r).shape.borderRadius},"square"===n.variant&&{borderRadius:0},n.colorDefault&&(0,s.Z)({color:(r.vars||r).palette.background.default},r.vars?{backgroundColor:r.vars.palette.Avatar.defaultBg}:{backgroundColor:"light"===r.palette.mode?r.palette.grey[400]:r.palette.grey[600]}))})),Z=(0,u.ZP)("img",{name:"MuiAvatar",slot:"Img",overridesResolver:function(e,r){return r.img}})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),w=(0,u.ZP)(m,{name:"MuiAvatar",slot:"Fallback",overridesResolver:function(e,r){return r.fallback}})({width:"75%",height:"75%"});var y,j=t.forwardRef((function(e,r){var n=(0,d.Z)({props:e,name:"MuiAvatar"}),i=n.alt,u=n.children,v=n.className,m=n.component,h=void 0===m?"div":m,p=n.imgProps,y=n.sizes,j=n.src,b=n.srcSet,k=n.variant,N=void 0===k?"circular":k,z=(0,a.Z)(n,x),M=null,I=function(e){var r=e.crossOrigin,n=e.referrerPolicy,i=e.src,a=e.srcSet,s=t.useState(!1),l=(0,o.Z)(s,2),c=l[0],u=l[1];return t.useEffect((function(){if(i||a){u(!1);var e=!0,t=new Image;return t.onload=function(){e&&u("loaded")},t.onerror=function(){e&&u("error")},t.crossOrigin=r,t.referrerPolicy=n,t.src=i,a&&(t.srcset=a),function(){e=!1}}}),[r,n,i,a]),c}((0,s.Z)({},p,{src:j,srcSet:b})),_=j||b,R=_&&"error"!==I,E=(0,s.Z)({},n,{colorDefault:!R,component:h,variant:N}),A=function(e){var r=e.classes,n={root:["root",e.variant,e.colorDefault&&"colorDefault"],img:["img"],fallback:["fallback"]};return(0,c.Z)(n,g,r)}(E);return M=R?(0,f.jsx)(Z,(0,s.Z)({alt:i,src:j,srcSet:b,sizes:y,ownerState:E,className:A.img},p)):null!=u?u:_&&i?i[0]:(0,f.jsx)(w,{ownerState:E,className:A.fallback}),(0,f.jsx)(S,(0,s.Z)({as:h,ownerState:E,className:(0,l.Z)(A.root,v),ref:r},z,{children:M}))})),b="Message_item__rK0d9",k="Message_itemOwn__BoBCX",N="Message_message__gAVOh",z="Message_messageOwn__GEo7u",M="Message_user__HDo5g",I=n(1087),_=n(1573),R=t.memo((function(e){var r=(0,_.i)((function(e){return e.auth}));return e.userId===r.userId?(0,f.jsx)(f.Fragment,{children:(0,f.jsx)("div",{className:k,style:{display:"flex",columnGap:10},children:(0,f.jsx)("div",{className:z,children:(0,f.jsx)("div",{children:null===e||void 0===e?void 0:e.message})})})}):(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)("div",{className:b,style:{display:"flex",columnGap:10},children:[(0,f.jsx)("div",{className:M,children:(0,f.jsx)(I.rU,{to:"/profile/"+e.userId,children:(0,f.jsx)(j,{style:{width:"50px",height:"50px"},src:e.photo||"https://img.freepik.com/free-icon/user_318-159711.jpg"})})}),(0,f.jsxs)("div",{className:N,children:[(0,f.jsx)("h2",{children:null===e||void 0===e?void 0:e.userName}),(0,f.jsx)("div",{children:null===e||void 0===e?void 0:e.message})]})]})})})),E=function(){var e=(0,_.i)((function(e){return e.chat.messages})),r=(0,t.useRef)(null),n=(0,t.useState)(!0),a=(0,o.Z)(n,2),s=a[0],l=a[1];return(0,t.useEffect)((function(){var e;s&&(null===(e=r.current)||void 0===e||e.scrollIntoView({block:"end"}))}),[e,s]),(0,f.jsxs)("div",{className:i,onScroll:function(e){var r=e.currentTarget;Math.abs(r.scrollHeight-r.scrollTop-r.clientHeight)<200?!s&&l(!0):s&&l(!1)},children:[e.map((function(e,r){return(0,f.jsx)(R,{message:e.message,userId:e.userId,userName:e.userName,photo:e.photo},r)})),(0,f.jsx)("div",{ref:r})]})},A=n(9434),C=n(4165),P=n(5861),B={"message-received":[],"status-changed":[]},D=function(e){var r=JSON.parse(e.data);B["message-received"].forEach((function(e){return e(r)}))};function L(){V("pending"),setTimeout(H,3e3)}function T(){V("error")}function F(){var e,r,n,t;null===(e=y)||void 0===e||e.removeEventListener("close",L),null===(r=y)||void 0===r||r.removeEventListener("message",L),null===(n=y)||void 0===n||n.removeEventListener("open",O),null===(t=y)||void 0===t||t.removeEventListener("error",T)}function O(){V("ready")}function V(e){B["status-changed"].forEach((function(r){return r(e)}))}function H(){var e,r,n,t,o;F(),null===(e=y)||void 0===e||e.close(),y=new WebSocket("wss://social-network.samuraijs.com/handlers/ChatHandler.ashx"),V("pending"),null===(r=y)||void 0===r||r.addEventListener("close",L),null===(n=y)||void 0===n||n.addEventListener("message",D),null===(t=y)||void 0===t||t.addEventListener("open",O),null===(o=y)||void 0===o||o.addEventListener("error",T)}var G=function(){H()},K=function(){var e;B["message-received"]=[],B["status-changed"]=[],F(),null===(e=y)||void 0===e||e.close()},q=function(e,r){B[e].push(r)},J=function(e,r){B[e]=B[e].filter((function(e){return e!==r}))},Q=function(e){var r;null===(r=y)||void 0===r||r.send(e)},U=n(1549),W=null,X=function(e){return null===W&&(W=function(r){e(re(r))}),W},Y=null,$=function(e){return null===Y&&(Y=function(r){e(ne(r))}),Y},ee=function(e){return function(){var r=(0,P.Z)((0,C.Z)().mark((function r(n){return(0,C.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:Q(e);case 1:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},re=function(e){return{type:U.lM,payload:e}},ne=function(e){return{type:U.KT,payload:e}},te=n(5413),oe=function(){var e=(0,t.useState)(""),r=(0,o.Z)(e,2),n=r[0],i=r[1],a=(0,_.i)((function(e){return e.chat.status})),s=(0,A.I0)();return(0,f.jsxs)("div",{style:{marginTop:"1em"},children:["pending"===a&&(0,f.jsx)(te.Z,{}),(0,f.jsx)("div",{children:(0,f.jsx)("textarea",{onKeyPress:function(e){if("Enter"===e.key){if(!n.trim())return;s(ee(n)),i("")}},onChange:function(e){return i(e.target.value)},value:n,name:"addMessageForm"})}),(0,f.jsx)("button",{disabled:0===n.length||"ready"!==a,onClick:function(){n.trim()&&(s(ee(n)),i(""))},children:"Send"})]})},ie=function(){var e=(0,_.i)((function(e){return e.chat.status})),r=(0,A.I0)();return(0,t.useEffect)((function(){return r(function(){var e=(0,P.Z)((0,C.Z)().mark((function e(r){return(0,C.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:G(),q("message-received",X(r)),q("status-changed",$(r));case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),function(){r(function(){var e=(0,P.Z)((0,C.Z)().mark((function e(r){return(0,C.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:J("message-received",X(r)),J("status-changed",X(r)),K();case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}())}}),[r]),"error"===e?(0,f.jsx)("div",{children:"Some error has occurred. Please refresh the page."}):(0,f.jsxs)("div",{children:[(0,f.jsx)(E,{}),(0,f.jsx)(oe,{})]})},ae=function(){return(0,f.jsx)("div",{children:(0,f.jsx)(ie,{})})}},9201:function(e,r,n){n.d(r,{Z:function(){return S}});var t=n(7462),o=n(2791),i=n(3366),a=n(8182),s=n(4419),l=n(4036),c=n(1402),u=n(6934),d=n(5878),v=n(1217);function f(e){return(0,v.Z)("MuiSvgIcon",e)}(0,d.Z)("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);var m=n(184),h=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],p=(0,u.ZP)("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:function(e,r){var n=e.ownerState;return[r.root,"inherit"!==n.color&&r["color".concat((0,l.Z)(n.color))],r["fontSize".concat((0,l.Z)(n.fontSize))]]}})((function(e){var r,n,t,o,i,a,s,l,c,u,d,v,f,m,h,p,g,x=e.theme,S=e.ownerState;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:S.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:null==(r=x.transitions)||null==(n=r.create)?void 0:n.call(r,"fill",{duration:null==(t=x.transitions)||null==(o=t.duration)?void 0:o.shorter}),fontSize:{inherit:"inherit",small:(null==(i=x.typography)||null==(a=i.pxToRem)?void 0:a.call(i,20))||"1.25rem",medium:(null==(s=x.typography)||null==(l=s.pxToRem)?void 0:l.call(s,24))||"1.5rem",large:(null==(c=x.typography)||null==(u=c.pxToRem)?void 0:u.call(c,35))||"2.1875rem"}[S.fontSize],color:null!=(d=null==(v=(x.vars||x).palette)||null==(f=v[S.color])?void 0:f.main)?d:{action:null==(m=(x.vars||x).palette)||null==(h=m.action)?void 0:h.active,disabled:null==(p=(x.vars||x).palette)||null==(g=p.action)?void 0:g.disabled,inherit:void 0}[S.color]}})),g=o.forwardRef((function(e,r){var n=(0,c.Z)({props:e,name:"MuiSvgIcon"}),u=n.children,d=n.className,v=n.color,g=void 0===v?"inherit":v,x=n.component,S=void 0===x?"svg":x,Z=n.fontSize,w=void 0===Z?"medium":Z,y=n.htmlColor,j=n.inheritViewBox,b=void 0!==j&&j,k=n.titleAccess,N=n.viewBox,z=void 0===N?"0 0 24 24":N,M=(0,i.Z)(n,h),I=o.isValidElement(u)&&"svg"===u.type,_=(0,t.Z)({},n,{color:g,component:S,fontSize:w,instanceFontSize:e.fontSize,inheritViewBox:b,viewBox:z,hasSvgAsChild:I}),R={};b||(R.viewBox=z);var E=function(e){var r=e.color,n=e.fontSize,t=e.classes,o={root:["root","inherit"!==r&&"color".concat((0,l.Z)(r)),"fontSize".concat((0,l.Z)(n))]};return(0,s.Z)(o,f,t)}(_);return(0,m.jsxs)(p,(0,t.Z)({as:S,className:(0,a.Z)(E.root,d),focusable:"false",color:y,"aria-hidden":!k||void 0,role:k?"img":void 0,ref:r},R,M,I&&u.props,{ownerState:_,children:[I?u.props.children:u,k?(0,m.jsx)("title",{children:k}):null]}))}));g.muiName="SvgIcon";var x=g;function S(e,r){function n(n,o){return(0,m.jsx)(x,(0,t.Z)({"data-testid":"".concat(r,"Icon"),ref:o},n,{children:e}))}return n.muiName=x.muiName,o.memo(o.forwardRef(n))}}}]);
//# sourceMappingURL=934.908c73c2.chunk.js.map